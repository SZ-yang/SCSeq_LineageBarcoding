table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
table(is.na(LCL_embedding))
seurat_obj
seurat_obj[["lcl"]] <- Seurat::CreateDimReducObject(LCL_embedding)
set.seed(10)
seurat_obj[["lcl.umap"]] <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(LCL_embedding))
dim(LCL_embedding)
set.seed(10)
seurat_obj <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(LCL_embedding),
assay = 'RNA',
reduction.name = 'lcl.umap',
reduction.key = 'lclUMAP_')
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_embedding)] <- TRUE
seurat_obj$test <- testing_vec
head(seurat_obj@meta.data)
Seurat::DimPlot(seurat_obj,
reduction = "lcl.umap",
group.by = "OG_condition")
Seurat::DimPlot(seurat_obj,
reduction = "lcl.umap",
group.by = "OG_condition",
cols = seurat_obj@misc[["OG_condition_colors"]])
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "OG_condition",
colors_use = seurat_obj@misc[["OG_condition_colors"]])
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
tab_vec <- table(seurat_obj$Lineage)
tab_vec <- order(tab_vec, decreasing = TRUE)
tab_vec <- table(seurat_obj$Lineage)
tab_vec <- sort(tab_vec, decreasing = TRUE)
i=1
lineage_name <- name(tab_vec)[i]
lineage_name <- names(tab_vec)[i]
lineage_name
tab_vec <- table(seurat_obj$Lineage)
tab_vec <- sort(tab_vec, decreasing = TRUE)
largest_lineage_vec <- rep(NA, length(Seurat::Cells(seurat_obj)))
names(largest_lineage_vec) <- Seurat::Cells(seurat_obj)
for(i in 1:5){
lineage_name <- names(tab_vec)[i]
largest_lineage_vec[which(seurat_obj$Lineage == lineage_name)] <- paste0("Lineage", i)
}
table(largest_lineage_vec)
seurat_obj$largest_lineage <- largest_lineage_vec
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec)
color_vec <- c(Lineage1 = rgb(203, 50, 39, maxColorValue = 255),
Lineage2 = rgb(65, 113, 170, maxColorValue = 255),
Lineage3 = rgb(131, 72, 149, maxColorValue = 255),
Lineage4 = rgb(92, 163, 77, maxColorValue = 255),
Lineage5 = rgb(235, 123, 44, maxColorValue = 255),
other = "gray")
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec)
?scCustomize::DimPlot_scCustom
?Seurat::DimPlot
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
color_vec <- c(Lineage1 = rgb(203, 50, 39, maxColorValue = 255),
Lineage2 = rgb(65, 113, 170, maxColorValue = 255),
Lineage3 = rgb(131, 72, 149, maxColorValue = 255),
Lineage4 = rgb(92, 163, 77, maxColorValue = 255),
Lineage5 = rgb(235, 123, 44, maxColorValue = 255),
other = "gray")
tab_vec <- table(seurat_obj$Lineage)
tab_vec <- sort(tab_vec, decreasing = TRUE)
largest_lineage_vec <- rep("other", length(Seurat::Cells(seurat_obj)))
names(largest_lineage_vec) <- Seurat::Cells(seurat_obj)
for(i in 1:5){
lineage_name <- names(tab_vec)[i]
largest_lineage_vec[which(seurat_obj$Lineage == lineage_name)] <- paste0("Lineage", i)
}
seurat_obj$largest_lineage <- largest_lineage_vec
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = "other")
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
seurat_obj
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_metadata <- read.csv(paste0(out_folder, "train_obs.csv"))
head(train_metadata)
test_metadata <- read.csv(paste0(out_folder, "test_obs.csv"))
rownames(test_metadata) <- test_metadata[,1]
names(clone_vec) <- c(rownames(train_metadata), rownames(test_metadata))
clone_vec <- c(train_metadata$clone_id, test_metadata$clone_id)
names(clone_vec) <- c(rownames(train_metadata), rownames(test_metadata))
seurat_obj$clone_id <- clone_vec[Seurat::Cells(seurat_obj)]
length(clone_vec)
seurat_obj
clone_vec <- rep(NA, length(Seurat::Cells(seurat_obj)))
names(clone_vec) <- Seurat::Cells(seurat_obj)
clone_vec[rownames(train_metadata)] <- train_metadata$clone_id
clone_vec[rownames(test_metadata)] <- test_metadata$clone_id
seurat_obj$clone_id <- clone_vec
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_embedding)] <- TRUE
table(testing_vec)
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_metadata)] <- TRUE
table(testing_vec)
seurat_obj$test <- testing_vec
seurat_obj
set.seed(10)
set.seed(10)
seurat_obj <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(seurat_obj[["lcl"]]@cell.embeddings),
assay = 'RNA',
reduction.name = 'lcl.umap',
reduction.key = 'lclUMAP_')
head(seurat_obj@meta.data)
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "cell_type")
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
color_vec <- c(Lineage1 = rgb(203, 50, 39, maxColorValue = 255),
Lineage2 = rgb(65, 113, 170, maxColorValue = 255),
Lineage3 = rgb(131, 72, 149, maxColorValue = 255),
Lineage4 = rgb(92, 163, 77, maxColorValue = 255),
Lineage5 = rgb(235, 123, 44, maxColorValue = 255),
other = "gray")
tab_vec <- table(seurat_obj$clone_id)
tab_vec <- sort(tab_vec, decreasing = TRUE)
largest_lineage_vec <- rep("other", length(Seurat::Cells(seurat_obj)))
names(largest_lineage_vec) <- Seurat::Cells(seurat_obj)
for(i in 1:5){
lineage_name <- names(tab_vec)[i]
largest_lineage_vec[which(seurat_obj$clone_id == lineage_name)] <- paste0("Lineage", i)
}
seurat_obj$largest_lineage <- largest_lineage_vec
table(seurat_obj$largest_lineage)
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
seurat_obj
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "python_X_tsne",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
rm(list=ls())
library(Seurat)
load("~/kzlinlab/data/biddy_2018_celltag/biddy_seurat.RData")
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_embedding <- read.csv(paste0(out_folder, "train_adata_LCL_other-lcl.csv"))
rownames(train_embedding) <- train_embedding[,1]
train_embedding <- as.matrix(train_embedding[,-1])
test_embedding <- read.csv(paste0(out_folder, "test_adata_LCL_other-lcl.csv"))
rownames(test_embedding) <- test_embedding[,1]
test_embedding <- as.matrix(test_embedding[,-1])
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
keep_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(keep_vec) <- Seurat::Cells(seurat_obj)
keep_vec[which(!is.na(LCL_embedding[,1]))] <- TRUE
seurat_obj$keep <- keep_vec
seurat_obj <- subset(seurat_obj, keep == TRUE)
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_metadata <- read.csv(paste0(out_folder, "train_obs.csv"))
rownames(train_metadata) <- train_metadata[,1]
test_metadata <- read.csv(paste0(out_folder, "test_obs.csv"))
rownames(test_metadata) <- test_metadata[,1]
clone_vec <- rep(NA, length(Seurat::Cells(seurat_obj)))
names(clone_vec) <- Seurat::Cells(seurat_obj)
clone_vec[rownames(train_metadata)] <- train_metadata$clone_id
clone_vec[rownames(test_metadata)] <- test_metadata$clone_id
seurat_obj$clone_id <- clone_vec
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_metadata)] <- TRUE
seurat_obj$test <- testing_vec
set.seed(10)
seurat_obj <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(seurat_obj[["lcl"]]@cell.embeddings),
assay = 'RNA',
reduction.name = 'lcl.umap',
reduction.key = 'lclUMAP_')
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "cell_type")
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_embedding <- read.csv(paste0(out_folder, "train_adata_LCL_other-lcl.csv"))
rownames(train_embedding) <- train_embedding[,1]
train_embedding <- as.matrix(train_embedding[,-1])
test_embedding <- read.csv(paste0(out_folder, "test_adata_LCL_other-lcl.csv"))
rownames(test_embedding) <- test_embedding[,1]
test_embedding <- as.matrix(test_embedding[,-1])
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
keep_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(keep_vec) <- Seurat::Cells(seurat_obj)
keep_vec[which(!is.na(LCL_embedding[,1]))] <- TRUE
seurat_obj$keep <- keep_vec
seurat_obj <- subset(seurat_obj, keep == TRUE)
seurat_obj
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_embedding <- read.csv(paste0(out_folder, "train_adata_LCL_other-lcl.csv"))
rownames(train_embedding) <- train_embedding[,1]
train_embedding <- as.matrix(train_embedding[,-1])
test_embedding <- read.csv(paste0(out_folder, "test_adata_LCL_other-lcl.csv"))
rownames(test_embedding) <- test_embedding[,1]
test_embedding <- as.matrix(test_embedding[,-1])
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
seurat_obj[["lcl"]] <- Seurat::CreateDimReducObject(LCL_embedding,
assay = "RNA")
set.seed(10)
seurat_obj <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(seurat_obj[["lcl"]]@cell.embeddings),
assay = 'RNA',
reduction.name = 'lcl.umap',
reduction.key = 'lclUMAP_')
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "cell_type")
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
train_metadata <- read.csv(paste0(out_folder, "train_obs.csv"))
rownames(train_metadata) <- train_metadata[,1]
test_metadata <- read.csv(paste0(out_folder, "test_obs.csv"))
rownames(test_metadata) <- test_metadata[,1]
clone_vec <- rep(NA, length(Seurat::Cells(seurat_obj)))
names(clone_vec) <- Seurat::Cells(seurat_obj)
clone_vec[rownames(train_metadata)] <- train_metadata$clone_id
clone_vec[rownames(test_metadata)] <- test_metadata$clone_id
seurat_obj$clone_id <- clone_vec
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_metadata)] <- TRUE
seurat_obj$test <- testing_vec
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
color_vec <- c(Lineage1 = rgb(203, 50, 39, maxColorValue = 255),
Lineage2 = rgb(65, 113, 170, maxColorValue = 255),
Lineage3 = rgb(131, 72, 149, maxColorValue = 255),
Lineage4 = rgb(92, 163, 77, maxColorValue = 255),
Lineage5 = rgb(235, 123, 44, maxColorValue = 255),
other = "gray")
tab_vec <- table(seurat_obj$clone_id)
tab_vec <- sort(tab_vec, decreasing = TRUE)
largest_lineage_vec <- rep("other", length(Seurat::Cells(seurat_obj)))
names(largest_lineage_vec) <- Seurat::Cells(seurat_obj)
for(i in 1:5){
lineage_name <- names(tab_vec)[i]
largest_lineage_vec[which(seurat_obj$clone_id == lineage_name)] <- paste0("Lineage", i)
}
seurat_obj$largest_lineage <- largest_lineage_vec
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "python_X_tsne",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
library(Seurat)
?Seurat::RunUMAP
library(scCustomize)
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
head(df)
teststat_vec <- df[,"Z"]
names(teststat_vec) <- df[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
teststat_vec <- df[,"Z"]
names(teststat_vec) <- df[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
gse <- clusterProfiler::gseGO(
teststat_vec,
ont = "BP", # what kind of pathways are you interested in
keyType = "SYMBOL",
OrgDb = "org.Mm.eg.db",
pvalueCutoff = 1,
minGSSize = 10,            # minimum gene set size
maxGSSize = 500            # maximum gene set size
)
gse_df <- as.data.frame(gse)
head(gse_df)
table(gse_df$p.adjust <= 0.05)
table(gse_df$pvalue <= 0.05)
gse_df[which(gse_df$pvalue <= 0.05), "Description"]
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
teststat_vec <- df_scvi[,"Z"]
names(teststat_vec) <- df_scvi[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
gse_scvi <- clusterProfiler::gseGO(
teststat_vec,
ont = "BP", # what kind of pathways are you interested in
keyType = "SYMBOL",
OrgDb = "org.Mm.eg.db",
pvalueCutoff = 1,
minGSSize = 10,            # minimum gene set size
maxGSSize = 500            # maximum gene set size
)
gse_df_scvi <- as.data.frame(gse_scvi)
table(gse_df_scvi$p.adjust <= 0.05)
table(gse_df_scvi$pvalue <= 0.05)
gse_df_scvi[which(gse_df_scvi$p.adjust <= 0.05), "Description"]
gse_df_scvi[which(gse_df_scvi$pvalue <= 0.05), "Description"]
head(df)
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
teststat_vec <- df[,"Z"]
names(teststat_vec) <- df[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
hist(df$Pval)
head(df_scvi)
plot(df$Pval, df_scvi$Pval, asp = TRUE)
plot(df$Pval, df_scvi$Pval, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
plot(df$Pval, df_scvi$Pval, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
?merge
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df)[-1] <- paste0("LCL_", colnames(df)[-1])
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df_scvi)[-1] <- paste0("scVI_", colnames(df_scvi)[-1])
df <- merge(x = df, y = df_scvi, by = "Gene")
head(df)
plot(df$LCL_Pval, df$scVI_Pval, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
#####################
plot(df$LCL_Z, df$scVI_Z, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1e6), c(0,1e6), col = 2, lwd = 2, lty = 2)
plot(df$LCL_C, df$scVI_C, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1e6), c(0,1e6), col = 2, lwd = 2, lty = 2)
plot(df$LCL_FDR, df$scVI_FDR, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
length(idx)
df[idx,"Gene"]
idx <- intersect(which(df$scVI_FDR <= 0.05),
which(df$LCL_FDR >= 0.05))
df[idx,"Gene"]
specific_genes <- c("Cdh1", "Apoa1", "Mettl7a1", "Wnt4", "Spint2",
"Dlk1", "Peg3", "Foxd2", "Zfp281")
table(specific_genes %in% rownames(df))
rownames(df)
table(specific_genes %in% df$Gene)
df[which(df$Gene %in% specific_genes),]
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/kevin_results/"
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
df[idx,"Gene"]
write.table(df[idx,"Gene"],
file = paste0(out_folder, "Writeup10b_in-lcl_not-in-scvi.csv"),
row.names = FALSE,
col.names = FALSE,
quote = FALSE)
df[idx,"Gene"]
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
df[idx,"Gene"]
write.table(df[idx,"Gene"],
file = paste0(out_folder, "Writeup10b_in-lcl_not-in-scvi.csv"),
row.names = FALSE,
col.names = FALSE,
quote = FALSE)
####
idx <- intersect(which(df$scVI_FDR <= 0.05),
which(df$LCL_FDR >= 0.05))
df[idx,"Gene"]
write.table(df[idx,"Gene"],
file = paste0(out_folder, "Writeup10b_in-scvi_not-in-lcl.csv"),
row.names = FALSE,
col.names = FALSE,
quote = FALSE)
df <- df[order(df$LCL_Z, decrasing = TRUE),]
order(df$LCL_Z, decrasing = TRUE)
df <- df[order(df$LCL_Z, decreasing = TRUE),]
head(df)
df <- df[order(df$LCL_Z, decreasing = TRUE),]
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
df[idx,"Gene"]
df["Hrh3",]
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/kevin_results/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df)[-1] <- paste0("LCL_", colnames(df)[-1])
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df_scvi)[-1] <- paste0("scVI_", colnames(df_scvi)[-1])
df <- merge(x = df, y = df_scvi, by = "Gene")
df <- df[order(df$LCL_Z, decreasing = TRUE),]
rownames(df) <- df$Gene
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
idx
df[idx,"Gene"]
df[796,]
