colors_use = color_vec,
order = paste0("Lineage", 1:5))
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
rm(list=ls())
library(Seurat)
load("~/kzlinlab/data/biddy_2018_celltag/biddy_seurat.RData")
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_embedding <- read.csv(paste0(out_folder, "train_adata_LCL_other-lcl.csv"))
rownames(train_embedding) <- train_embedding[,1]
train_embedding <- as.matrix(train_embedding[,-1])
test_embedding <- read.csv(paste0(out_folder, "test_adata_LCL_other-lcl.csv"))
rownames(test_embedding) <- test_embedding[,1]
test_embedding <- as.matrix(test_embedding[,-1])
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
keep_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(keep_vec) <- Seurat::Cells(seurat_obj)
keep_vec[which(!is.na(LCL_embedding[,1]))] <- TRUE
seurat_obj$keep <- keep_vec
seurat_obj <- subset(seurat_obj, keep == TRUE)
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_metadata <- read.csv(paste0(out_folder, "train_obs.csv"))
rownames(train_metadata) <- train_metadata[,1]
test_metadata <- read.csv(paste0(out_folder, "test_obs.csv"))
rownames(test_metadata) <- test_metadata[,1]
clone_vec <- rep(NA, length(Seurat::Cells(seurat_obj)))
names(clone_vec) <- Seurat::Cells(seurat_obj)
clone_vec[rownames(train_metadata)] <- train_metadata$clone_id
clone_vec[rownames(test_metadata)] <- test_metadata$clone_id
seurat_obj$clone_id <- clone_vec
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_metadata)] <- TRUE
seurat_obj$test <- testing_vec
set.seed(10)
seurat_obj <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(seurat_obj[["lcl"]]@cell.embeddings),
assay = 'RNA',
reduction.name = 'lcl.umap',
reduction.key = 'lclUMAP_')
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "cell_type")
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_embedding <- read.csv(paste0(out_folder, "train_adata_LCL_other-lcl.csv"))
rownames(train_embedding) <- train_embedding[,1]
train_embedding <- as.matrix(train_embedding[,-1])
test_embedding <- read.csv(paste0(out_folder, "test_adata_LCL_other-lcl.csv"))
rownames(test_embedding) <- test_embedding[,1]
test_embedding <- as.matrix(test_embedding[,-1])
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
keep_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(keep_vec) <- Seurat::Cells(seurat_obj)
keep_vec[which(!is.na(LCL_embedding[,1]))] <- TRUE
seurat_obj$keep <- keep_vec
seurat_obj <- subset(seurat_obj, keep == TRUE)
seurat_obj
rm(list=ls())
library(Seurat)
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup9b/"
load(paste0(out_folder, "Writeup9b_celltag-data_with_LCL.RData"))
train_embedding <- read.csv(paste0(out_folder, "train_adata_LCL_other-lcl.csv"))
rownames(train_embedding) <- train_embedding[,1]
train_embedding <- as.matrix(train_embedding[,-1])
test_embedding <- read.csv(paste0(out_folder, "test_adata_LCL_other-lcl.csv"))
rownames(test_embedding) <- test_embedding[,1]
test_embedding <- as.matrix(test_embedding[,-1])
table(rownames(train_embedding) %in% Seurat::Cells(seurat_obj))
table(rownames(test_embedding) %in% Seurat::Cells(seurat_obj))
LCL_embedding <- matrix(NA, nrow = length(Seurat::Cells(seurat_obj)), ncol = ncol(train_embedding))
rownames(LCL_embedding) <- Seurat::Cells(seurat_obj)
colnames(LCL_embedding) <- paste0("LCL_", 1:ncol(LCL_embedding))
LCL_embedding[rownames(train_embedding),] <- train_embedding
LCL_embedding[rownames(test_embedding),] <- test_embedding
seurat_obj[["lcl"]] <- Seurat::CreateDimReducObject(LCL_embedding,
assay = "RNA")
set.seed(10)
seurat_obj <- Seurat::RunUMAP(seurat_obj,
reduction = "lcl",
dims = 1:ncol(seurat_obj[["lcl"]]@cell.embeddings),
assay = 'RNA',
reduction.name = 'lcl.umap',
reduction.key = 'lclUMAP_')
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "cell_type")
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
train_metadata <- read.csv(paste0(out_folder, "train_obs.csv"))
rownames(train_metadata) <- train_metadata[,1]
test_metadata <- read.csv(paste0(out_folder, "test_obs.csv"))
rownames(test_metadata) <- test_metadata[,1]
clone_vec <- rep(NA, length(Seurat::Cells(seurat_obj)))
names(clone_vec) <- Seurat::Cells(seurat_obj)
clone_vec[rownames(train_metadata)] <- train_metadata$clone_id
clone_vec[rownames(test_metadata)] <- test_metadata$clone_id
seurat_obj$clone_id <- clone_vec
testing_vec <- rep(FALSE, length(Seurat::Cells(seurat_obj)))
names(testing_vec) <- Seurat::Cells(seurat_obj)
testing_vec[rownames(test_metadata)] <- TRUE
seurat_obj$test <- testing_vec
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "test")
color_vec <- c(Lineage1 = rgb(203, 50, 39, maxColorValue = 255),
Lineage2 = rgb(65, 113, 170, maxColorValue = 255),
Lineage3 = rgb(131, 72, 149, maxColorValue = 255),
Lineage4 = rgb(92, 163, 77, maxColorValue = 255),
Lineage5 = rgb(235, 123, 44, maxColorValue = 255),
other = "gray")
tab_vec <- table(seurat_obj$clone_id)
tab_vec <- sort(tab_vec, decreasing = TRUE)
largest_lineage_vec <- rep("other", length(Seurat::Cells(seurat_obj)))
names(largest_lineage_vec) <- Seurat::Cells(seurat_obj)
for(i in 1:5){
lineage_name <- names(tab_vec)[i]
largest_lineage_vec[which(seurat_obj$clone_id == lineage_name)] <- paste0("Lineage", i)
}
seurat_obj$largest_lineage <- largest_lineage_vec
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "lcl.umap",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
Seurat::Idents(seurat_obj) <- "largest_lineage"
scCustomize::DimPlot_scCustom(seurat_obj,
reduction = "python_X_tsne",
group.by = "largest_lineage",
colors_use = color_vec,
order = paste0("Lineage", 1:5))
library(Seurat)
?Seurat::RunUMAP
library(scCustomize)
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
head(df)
teststat_vec <- df[,"Z"]
names(teststat_vec) <- df[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
teststat_vec <- df[,"Z"]
names(teststat_vec) <- df[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
gse <- clusterProfiler::gseGO(
teststat_vec,
ont = "BP", # what kind of pathways are you interested in
keyType = "SYMBOL",
OrgDb = "org.Mm.eg.db",
pvalueCutoff = 1,
minGSSize = 10,            # minimum gene set size
maxGSSize = 500            # maximum gene set size
)
gse_df <- as.data.frame(gse)
head(gse_df)
table(gse_df$p.adjust <= 0.05)
table(gse_df$pvalue <= 0.05)
gse_df[which(gse_df$pvalue <= 0.05), "Description"]
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
teststat_vec <- df_scvi[,"Z"]
names(teststat_vec) <- df_scvi[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
gse_scvi <- clusterProfiler::gseGO(
teststat_vec,
ont = "BP", # what kind of pathways are you interested in
keyType = "SYMBOL",
OrgDb = "org.Mm.eg.db",
pvalueCutoff = 1,
minGSSize = 10,            # minimum gene set size
maxGSSize = 500            # maximum gene set size
)
gse_df_scvi <- as.data.frame(gse_scvi)
table(gse_df_scvi$p.adjust <= 0.05)
table(gse_df_scvi$pvalue <= 0.05)
gse_df_scvi[which(gse_df_scvi$p.adjust <= 0.05), "Description"]
gse_df_scvi[which(gse_df_scvi$pvalue <= 0.05), "Description"]
head(df)
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
teststat_vec <- df[,"Z"]
names(teststat_vec) <- df[,"Gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
hist(df$Pval)
head(df_scvi)
plot(df$Pval, df_scvi$Pval, asp = TRUE)
plot(df$Pval, df_scvi$Pval, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
plot(df$Pval, df_scvi$Pval, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
?merge
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df)[-1] <- paste0("LCL_", colnames(df)[-1])
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df_scvi)[-1] <- paste0("scVI_", colnames(df_scvi)[-1])
df <- merge(x = df, y = df_scvi, by = "Gene")
head(df)
plot(df$LCL_Pval, df$scVI_Pval, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
#####################
plot(df$LCL_Z, df$scVI_Z, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1e6), c(0,1e6), col = 2, lwd = 2, lty = 2)
plot(df$LCL_C, df$scVI_C, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1e6), c(0,1e6), col = 2, lwd = 2, lty = 2)
plot(df$LCL_FDR, df$scVI_FDR, asp = TRUE, pch = 16, col = rgb(0.5, 0.5, 0.5, 0.5))
lines(c(0,1), c(0,1), col = 2, lwd = 2, lty = 2)
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
length(idx)
df[idx,"Gene"]
idx <- intersect(which(df$scVI_FDR <= 0.05),
which(df$LCL_FDR >= 0.05))
df[idx,"Gene"]
specific_genes <- c("Cdh1", "Apoa1", "Mettl7a1", "Wnt4", "Spint2",
"Dlk1", "Peg3", "Foxd2", "Zfp281")
table(specific_genes %in% rownames(df))
rownames(df)
table(specific_genes %in% df$Gene)
df[which(df$Gene %in% specific_genes),]
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/kevin_results/"
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
df[idx,"Gene"]
write.table(df[idx,"Gene"],
file = paste0(out_folder, "Writeup10b_in-lcl_not-in-scvi.csv"),
row.names = FALSE,
col.names = FALSE,
quote = FALSE)
df[idx,"Gene"]
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
df[idx,"Gene"]
write.table(df[idx,"Gene"],
file = paste0(out_folder, "Writeup10b_in-lcl_not-in-scvi.csv"),
row.names = FALSE,
col.names = FALSE,
quote = FALSE)
####
idx <- intersect(which(df$scVI_FDR <= 0.05),
which(df$LCL_FDR >= 0.05))
df[idx,"Gene"]
write.table(df[idx,"Gene"],
file = paste0(out_folder, "Writeup10b_in-scvi_not-in-lcl.csv"),
row.names = FALSE,
col.names = FALSE,
quote = FALSE)
df <- df[order(df$LCL_Z, decrasing = TRUE),]
order(df$LCL_Z, decrasing = TRUE)
df <- df[order(df$LCL_Z, decreasing = TRUE),]
head(df)
df <- df[order(df$LCL_Z, decreasing = TRUE),]
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
df[idx,"Gene"]
df["Hrh3",]
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
data_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/"
out_folder <- "/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-hotspot/kevin_results/"
df <- read.csv(paste0(data_folder, "LCL_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df)[-1] <- paste0("LCL_", colnames(df)[-1])
df_scvi <- read.csv(paste0(data_folder, "scVI_celltagMulti_hotspot_autocorrelations.csv"))
colnames(df_scvi)[-1] <- paste0("scVI_", colnames(df_scvi)[-1])
df <- merge(x = df, y = df_scvi, by = "Gene")
df <- df[order(df$LCL_Z, decreasing = TRUE),]
rownames(df) <- df$Gene
idx <- intersect(which(df$LCL_FDR <= 0.05),
which(df$scVI_FDR >= 0.05))
idx
df[idx,"Gene"]
df[796,]
180+30+130-60
180+30+130-60+40
180+30+130+40
180+30*5-60
180+30*5-60+80
60+20
310-80
180+180+30
180+170
?image
180+150
90*5-60
?knn
# https://github.com/SZ-yang/SCSeq_LineageBarcoding/blob/kevin/kevin/Writeup5_GEMLI/Writeup5_LARRY_gsea-plotting.R
rm(list=ls())
library(org.Mm.eg.db)
library(clusterProfiler)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Collaboration-and-People/Joshua/out/kevin/Writeup10b_joshua-IG/IG_analysis_res.csv")
head(df)
teststat_vec <- df[,"score_001_15"]
names(teststat_vec) <- df[,"gene"]
teststat_vec <- sort(teststat_vec, decreasing = TRUE)
set.seed(10)
gse <- clusterProfiler::gseGO(
teststat_vec,
ont = "BP", # what kind of pathways are you interested in
keyType = "SYMBOL",
OrgDb = "org.Mm.eg.db",
pvalueCutoff = 1,
minGSSize = 10,            # minimum gene set size
maxGSSize = 500            # maximum gene set size
)
gse_df <- as.data.frame(gse)
table(gse_df$p.adjust <= 0.05)
table(gse_df$pvalue <= 0.05)
gse_df[which(gse_df$pvalue <= 0.05), "Description"]
table(gse_df$p.adjust <= 0.05)
gse_df[which(gse_df$p.adjust <= 0.05), "Description"]
3669+1508+1357
27081+12266+1746
library(MASS)
library(ggplot2)
library(class)
library(pracma)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv")
head(df)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv",
col.names = FALSE)
df <- read.table("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv")
head(df)
df <- read.table("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv",
sep = ",")
head(df)
library(MASS)
library(ggplot2)
library(class)
library(pracma)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv",
header = FALSE)
df <- df[,c(2,3,4)]
rm(list=ls())
library(MASS)
library(ggplot2)
library(class)
library(pracma)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv",
header = FALSE)
df <- df[,c(2,3,4)]
head(df)
rm(list=ls())
library(MASS)
library(ggplot2)
library(class)
library(pracma)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv",
header = FALSE)
df <- df[,c(2,3,4)]
colnames(df) <- c("diagnosis","radius","texture")
df$diagnosis <- factor(df$diagnosis)
### split the data into training and test sets
### set a random seed here in order to be able to reproduce your results later
set.seed(123)
index = sort(sample(dim(df)[1],400))
train = df[index,]
test = df[-index,]
##################### logistic regression #########################
mod_glm <- stats::glm(diagnosis ~ radius + texture,
data=train,
family="binomial")
coef <- stats::coef(mod_glm)
summary(df)
### predictions
expit <- function(x){exp(x)/(1+exp(x))}
pred_e <- expit(coef[1,1]+10*coef[2,1]+12*coef[3,1])
newdata_e <- train[1,]
newdata_e[1,2] <- 10
newdata_e[1,3] <- 12
stats::predict(mod_glm, type="response", newdata=newdata_e)
coef
pred_e <- expit(coef[1]+10*coef[2]+12*coef[3])
newdata_e <- train[1,]
newdata_e[1,2] <- 10
newdata_e[1,3] <- 12
stats::predict(mod_glm, type="response", newdata=newdata_e)
### decision boundary
radius_grid <- seq(5,30,length=101)
texture_grid <- seq(5,40,length=101)
griddata <- expand.grid(radius_grid,texture_grid)
colnames(griddata) <- c("radius","texture")
grid_prob <- predict(mod_glm,type="response",newdata=griddata)
rm(list=ls())
library(MASS)
library(ggplot2)
library(class)
library(pracma)
df <- read.csv("/Users/kevinlin/Library/CloudStorage/Dropbox/Coursework/UW-BIOST-546_w2026/kevin/Homework/wdbc.csv",
header = FALSE)
df <- df[,c(2,3,4)]
colnames(df) <- c("diagnosis","radius","texture")
df$diagnosis <- factor(df$diagnosis)
### split the data into training and test sets
### set a random seed here in order to be able to reproduce your results later
set.seed(123)
index = sort(sample(dim(df)[1],400))
train = df[index,]
test = df[-index,]
##################### logistic regression #########################
mod_glm <- stats::glm(diagnosis ~ radius + texture,
data=train,
family="binomial")
coef <- stats::coef(mod_glm)
### predictions
expit <- function(x){exp(x)/(1+exp(x))}
pred_e <- expit(coef[1]+10*coef[2]+12*coef[3])
newdata_e <- train[1,]
newdata_e[1,2] <- 10
newdata_e[1,3] <- 12
stats::predict(mod_glm, type="response", newdata=newdata_e)
### decision boundary
radius_grid <- seq(5,30,length=101)
texture_grid <- seq(5,40,length=101)
griddata <- expand.grid(radius_grid,texture_grid)
colnames(griddata) <- c("radius","texture")
grid_prob <- predict(mod_glm,type="response",newdata=griddata)
cutoff <- 0.5
grid_pred <- ifelse(grid_prob>cutoff[i],"M","B")
### decision boundary
radius_grid <- seq(5,30,length=101)
texture_grid <- seq(5,40,length=101)
griddata <- expand.grid(radius_grid,texture_grid)
colnames(griddata) <- c("radius","texture")
grid_prob <- predict(mod_glm,type="response",newdata=griddata)
cutoff <- 0.5
grid_pred <- ifelse(grid_prob>cutoff,"M","B")
grid_df <- data.frame(cbind(grid_pred,griddata))
colnames(grid_df)[1] <- "diagnosis"
datplot <- rbind(train,grid_df)
datplot$dataset <- c(rep("train",400), rep("grid",dim(grid_df)[1]))
datplot$plotsize <- c(rep(2,400), rep(0.002,dim(grid_df)[1]))
ggplot(datplot, aes(x=radius, y=texture, color=diagnosis,shape=dataset)) + geom_point(size=datplot$plotsize)
datplot <- rbind(train,grid_df)
datplot$dataset <- c(rep("train",400), rep("grid",dim(grid_df)[1]))
datplot$plotsize <- c(rep(2,400), rep(0.1,dim(grid_df)[1]))
ggplot(datplot, aes(x=radius, y=texture, color=diagnosis,shape=dataset)) + geom_point(size=datplot$plotsize)
datplot <- rbind(train,grid_df)
datplot$dataset <- c(rep("train",400), rep("grid",dim(grid_df)[1]))
datplot$plotsize <- c(rep(2,400), rep(0.5,dim(grid_df)[1]))
ggplot(datplot, aes(x=radius, y=texture, color=diagnosis,shape=dataset)) + geom_point(size=datplot$plotsize)
library(AUC)
install.packages("AUC")
library(AUC)
### ROC and AUC
pred_vec <- stats::predict(mod_glm, newdata = train, type = "response")
pred_vec
?stats::predict.glm
head(train)
factor(train$diagnosis)
### ROC and AUC
pred_vec <- stats::predict(mod_glm, newdata = train, type = "response")
roc_res <- AUC::roc(predictions = pred_vec,
labels = train$diagnosis)
roc_res
plot(roc_res)
int_cur <- 52042
us_cur <- 118988
total_cur <- int_cur+us_cur
total_new <- total_cur+1000
int_new <- total_new*.3
us_new <- total_new*.7
us_add <- us_new-us_cur
int_add <- int_new-int_cur
us_add
